#!/usr/bin/env bash

# Function to start the database
start_db() {
    docker-compose up -d --remove-orphans
}

# Function to stop the database
stop_db() {
    docker-compose down --remove-orphans
}

# Function to enter the Nix shell
enter_nix_shell() {
    nix-shell
}

# Function to run the Python application
run_app() {
    python app/main.py
}

usage() {
    echo "Usage: $0 {command}"
    echo ""
    echo "Available commands:"
    echo "  up   Start the PostgreSQL database using Docker Compose."
    echo "  down Stop the PostgreSQL database and remove any orphaned containers."
    echo "  env  Enter the Nix shell environment for development."
    echo "  run  Run the Python application (installs dependencies if not already done)."
    echo ""
}

# Parse command-line arguments
case "$1" in
    up) start_db ;;
    down) stop_db ;;
    env) enter_nix_shell ;;
    run) run_app ;;
    *) usage ;;
esac

